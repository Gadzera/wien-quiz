<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Wiener Ortskunde Quiz</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
  body,html { height:100%; margin:0; font-family:sans-serif; }
  #map { height:100%; width:100%; }

  .menu-btn { position:absolute; top:12px; right:12px; z-index:1100;
              padding:10px 16px; border-radius:8px; color:white; font-weight:600; cursor:pointer; background:#2563eb; }

  .sidebar { position:absolute; top:60px; right:12px; z-index:1000;
             width:300px; max-height:80vh; overflow-y:auto;
             background:white; border-radius:12px; padding:12px;
             box-shadow:0 4px 16px rgba(0,0,0,0.15); display:none; }
  .category { display:flex; align-items:center; gap:6px; padding:8px; margin:6px 0;
              border-radius:8px; background:#f8fafc; font-size:14px;
              border-left:4px solid #2563eb; font-weight:500; }

  /* –ü–∞–Ω–µ–ª—å –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã —Å–ø—Ä–∞–≤–∞ */
  .quiz-panel { position:absolute; top:80px; right:12px;
                z-index:1000; background:white; padding:16px; border-radius:12px;
                width:300px; max-height:80vh; overflow-y:auto;
                box-shadow:0 4px 16px rgba(0,0,0,0.15);
                display:none; }
  .question { font-size:15px; font-weight:600; margin-bottom:12px; text-align:center; }
  .progress { font-size:13px; text-align:center; color:#666; margin-bottom:8px; }
  .options { display:grid; gap:6px; }
  .option { padding:10px; border:1px solid #d1d5db; border-radius:8px; cursor:pointer; }
  .option:hover { border-color:#2563eb; background:#f0f9ff; }
  .option.correct { border-color:#16a34a; background:#f0fdf4; }
  .option.incorrect { border-color:#dc2626; background:#fef2f2; }
  .next-btn, .end-btn { margin-top:12px; padding:8px 16px; background:#2563eb; color:white;
                        border:none; border-radius:6px; cursor:pointer; width:100%; font-weight:600; }

  /* Login modal */
  #loginModal { position:fixed; top:0; left:0; width:100%; height:100%;
                background:rgba(0,0,0,0.5); display:flex; align-items:center; justify-content:center; z-index:2000; }
  #loginBox { background:#f9f9f9; padding:24px; border-radius:8px; width:90%; max-width:360px; text-align:center;
              box-shadow:0 6px 18px rgba(0,0,0,0.25); }
  #loginBox h2 { margin:0 0 20px 0; font-size:20px; color:#333; font-weight:600; }
  #loginBox input { width:100%; padding:12px; margin:10px 0; border:1px solid #ccc; border-radius:6px; font-size:14px; background:#f3f3f3; }
  #loginBox input:focus { border-color:#2563eb; outline:none; background:#fff; }
  .login-btn { margin-top:12px; padding:12px; width:100%; border:none; border-radius:6px; background:linear-gradient(to bottom,#ffcc66,#ff9933); color:#333; font-weight:600; cursor:pointer; font-size:15px; box-shadow:0 3px 6px rgba(0,0,0,0.2); }
  .login-links { margin-top:10px; font-size:13px; }
  .login-links a { color:#2563eb; text-decoration:none; cursor:pointer; }
</style>
</head>
<body>
<div id="map"></div>
<div class="menu-btn" onclick="toggleMenu()">Men√º</div>

<div class="sidebar" id="sidebar">
  <label class="category"><input type="checkbox" value="regierungs"> üèõÔ∏è Regierungsgeb√§ude</label>
  <label class="category"><input type="checkbox" value="gerichte"> ‚öñÔ∏è Gerichtsgeb√§ude</label>
  <button onclick="startMultiQuiz()" style="margin-top:12px; padding:8px; width:100%; background:#2563eb; color:white; border:none; border-radius:6px; font-weight:600;">Quiz starten</button>
</div>

<!-- –ü–∞–Ω–µ–ª—å –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã -->
<div class="quiz-panel" id="quizPanel">
  <div class="progress" id="progress"></div>
  <div class="question" id="questionText"></div>
  <div class="options" id="optionsContainer"></div>
  <button class="next-btn" onclick="nextQuestion()" style="display:none;" id="nextBtn">Weiter ‚Üí</button>
  <div id="endBtns" style="display:none;">
    <button class="end-btn" onclick="restartQuiz()">üîÑ Nochmal spielen</button>
    <button class="end-btn" onclick="backToMenu()">üìñ Zur√ºck</button>
  </div>
</div>

<!-- Login -->
<div id="loginModal">
  <div id="loginBox">
    <h2 id="formTitle">Login</h2>
    <input type="email" id="loginEmail" placeholder="Email">
    <input type="password" id="loginPass" placeholder="Password">
    <input type="password" id="loginPass2" placeholder="Repeat Password" style="display:none;">
    <button onclick="submitForm()" class="login-btn" id="submitBtn">Log in</button>
    <p id="loginError" style="color:red; font-size:12px;"></p>
    <div class="login-links">
      <a onclick="toggleForm(true)">Register</a> | 
      <a onclick="toggleForm(false)">Login</a>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyCqVNVOXqYlPryEvjIYkOyp3BrWMtRMlGg",
  authDomain: "wien-quiz.firebaseapp.com",
  databaseURL: "https://wien-quiz-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "wien-quiz",
  storageBucket: "wien-quiz.firebasestorage.app",
  messagingSenderId: "467695563938",
  appId: "1:467695563938:web:87b15a9b5de5d3764bd3fb",
  measurementId: "G-SN0SMY9NH2"
};
  
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

// --- –í–æ–ø—Ä–æ—Å—ã ---
const quizData = {
 regierungs: [
    { name:"Parlament (Nationalrat und Bundesrat)", question:"Wo befindet sich das Parlament?", options:["Dr.-Karl-Renner-Ring 3","Ballhausplatz 2","Minoritenplatz 5","Stubenring 1"], correctAnswer:"Dr.-Karl-Renner-Ring 3", coordinates:[48.208200420886755, 16.35916158251087] },
    { name:"Bundespr√§sident (Pr√§sidentschaftskanzlei)", question:"Wo befindet sich die Pr√§sidentschaftskanzlei?", options:["Ballhausplatz 1","Herrengasse 7","Johannesgasse 5","Stubenring 1"], correctAnswer:"Ballhausplatz 1", coordinates:[48.20800169709753, 16.363951691458396] },
    { name:"Bundeskanzleramt", question:"Wo befindet sich das Bundeskanzleramt?", options:["Ballhausplatz 2","Minoritenplatz 8","Museumstra√üe 7","Radetzkystra√üe 2"], correctAnswer:"Ballhausplatz 2", coordinates:[48.20854761977208, 16.363727653675692] },
    { name:"BM f√ºr Inneres", question:"Wo befindet sich das BM f√ºr Inneres?", options:["Herrengasse 7","Johannesgasse 5","Stubenring 1","Ballhausplatz 2"], correctAnswer:"Herrengasse 7", coordinates:[48.20925481780634, 16.365909640181602] },
    { name:"BM f√ºr Europ√§ische und Internationale Angelegenheiten", question:"Wo befindet sich das BM f√ºr Europ√§ische und Internationale Angelegenheiten?", options:["Minoritenplatz 8","Dr.-Karl-Renner-Ring 3","Radetzkystra√üe 2","Ballhausplatz 1"], correctAnswer:"Minoritenplatz 8", coordinates:[48.209476268473004, 16.364686524840423] },
    { name:"BM f√ºr Bildung, Wissenschaft und Forschung", question:"Wo befindet sich das BM f√ºr Bildung, Wissenschaft und Forschung?", options:["Minoritenplatz 5","Herrengasse 7","Museumstra√üe 7","Johannesgasse 5"], correctAnswer:"Minoritenplatz 5", coordinates:[48.21005255130992, 16.36359571996366] },
    { name:"BM f√ºr Digitalisierung und Wirtschaftsstandort", question:"Wo befindet sich das BM f√ºr Digitalisierung und Wirtschaftsstandort?", options:["Stubenring 1","Ro√üauer L√§nde 1","Ballhausplatz 2","Museumstra√üe 7"], correctAnswer:"Stubenring 1", coordinates:[48.21004291602488, 16.38297064202857] },
    { name:"BM f√ºr Arbeit", question:"Wo befindet sich das BM f√ºr Arbeit?", options:["Taborstra√üe 1-3","Minoritenplatz 8","Dr.-Karl-Renner-Ring 3","Radetzkystra√üe 2"], correctAnswer:"Taborstra√üe 1-3", coordinates:[48.213122753010396, 16.379013197852277] },
    { name:"BM f√ºr Finanzen", question:"Wo befindet sich das BM f√ºr Finanzen?", options:["Johannesgasse 5","Ballhausplatz 1","Stubenring 1","Museumstra√üe 7"], correctAnswer:"Johannesgasse 5", coordinates:[48.205323477367855, 16.37220709785196] },
    { name:"BM f√ºr Klimaschutz, Umwelt, Energie, Mobilit√§t, Innovation und Technologie", question:"Wo befindet sich das BM f√ºr Klimaschutz, Umwelt, Energie, Mobilit√§t, Innovation und Technologie?", options:["Radetzkystra√üe 2","Stubenring 1","Ro√üauer L√§nde 1","Herrengasse 7"], correctAnswer:"Radetzkystra√üe 2", coordinates:[48.21119280876316, 16.38638176901679] },
    { name:"BM f√ºr Kunst, Kultur, √∂ffentlichen Dienst und Sport", question:"Wo befindet sich das BM f√ºr Kunst, Kultur, √∂ffentlichen Dienst und Sport?", options:["Radetzkystra√üe 2","Johannesgasse 5","Dr.-Karl-Renner-Ring 3","Minoritenplatz 5"], correctAnswer:"Radetzkystra√üe 2", coordinates:[48.21108976120188, 16.386582797852217] },
    { name:"BM f√ºr Landwirtschaft, Regionen und Tourismus", question:"Wo befindet sich das BM f√ºr Landwirtschaft, Regionen und Tourismus?", options:["Stubenring 1","Ballhausplatz 2","Ro√üauer L√§nde 1","Museumstra√üe 7"], correctAnswer:"Stubenring 1", coordinates:[48.21017215942227, 16.383023597852194] },
    { name:"BM f√ºr Soziales, Gesundheit, Pflege und Konsumentenschutz", question:"Wo befindet sich das BM f√ºr Soziales, Gesundheit, Pflege und Konsumentenschutz?", options:["Stubenring 1","Minoritenplatz 8","Johannesgasse 5","Ballhausplatz 1"], correctAnswer:"Stubenring 1", coordinates:[48.20979016335292, 16.382849297852154] },
    { name:"BM f√ºr Justiz", question:"Wo befindet sich das BM f√ºr Justiz?", options:["Museumstra√üe 7","Herrengasse 7","Johannesgasse 5","Stubenring 1"], correctAnswer:"Museumstra√üe 7", coordinates:[48.20581717886796, 16.355142309499076] },
    { name:"BM f√ºr Landesverteidigung", question:"Wo befindet sich das BM f√ºr Landesverteidigung?", options:["Ro√üauer L√§nde 1","Ballhausplatz 2","Stubenring 1","Johannesgasse 5"], correctAnswer:"Ro√üauer L√§nde 1", coordinates:[48.219309896635856, 16.36798294387597] },
    { name:"Rathaus", question:"Wo befindet sich das Wiener Rathaus?", options:["Rathausplatz 1","Stubenring 1","Johannesgasse 5","Minoritenplatz 8"], correctAnswer:"Rathausplatz 1", coordinates:[48.21110695472529, 16.358082597852153] }
  ],
  gerichte: [
    { name:"Verfassungsgerichtshof", question:"Wo befindet sich der Verfassungsgerichtshof?", options:["Freyung 8","Judenplatz 11","Schmerlingplatz 10-11","Stubenring 1"], correctAnswer:"Freyung 8", coordinates:[48.210,16.364] },
    { name:"Verwaltungsgerichtshof", question:"Wo befindet sich der Verwaltungsgerichtshof?", options:["Judenplatz 11","Freyung 8","Stubenring 1","Ballhausplatz 2"], correctAnswer:"Judenplatz 11", coordinates:[48.211,16.369] },
    { name:"Oberster Gerichtshof", question:"Wo befindet sich der Oberste Gerichtshof?", options:["Schmerlingplatz 10-11","Landesgerichtsstra√üe 11","Herrengasse 7","Ballhausplatz 1"], correctAnswer:"Schmerlingplatz 10-11", coordinates:[48.207,16.357] },
    { name:"Oberlandesgericht Wien", question:"Wo befindet sich das Oberlandesgericht Wien?", options:["Schmerlingplatz 10-11","Freyung 8","Judenplatz 11","Ballhausplatz 1"], correctAnswer:"Schmerlingplatz 10-11", coordinates:[48.207,16.357] },
    { name:"Oberstaatsanwaltschaft Wien", question:"Wo befindet sich die Oberstaatsanwaltschaft Wien?", options:["Schmerlingplatz 10-11","Landesgerichtsstra√üe 11","Stubenring 1","Radetzkystra√üe 2"], correctAnswer:"Schmerlingplatz 10-11", coordinates:[48.207,16.357] },
    { name:"Landesgericht f. Zivilrechtssachen", question:"Wo befindet sich das Landesgericht f√ºr Zivilrechtssachen Wien?", options:["Schmerlingplatz 10-11","Judenplatz 11","Freyung 8","Dampfschiffstra√üe 2"], correctAnswer:"Schmerlingplatz 10-11", coordinates:[48.207,16.357] },
    { name:"Landesgericht f. Strafsachen", question:"Wo befindet sich das Landesgericht f√ºr Strafsachen?", options:["Landesgerichtsstra√üe 11","Schmerlingplatz 10-11","Herrengasse 7","Johannesgasse 5"], correctAnswer:"Landesgerichtsstra√üe 11", coordinates:[48.215,16.350] },
    { name:"Justizanstalt Wien Josefstadt", question:"Wo befindet sich die Justizanstalt Wien Josefstadt?", options:["Wickenburggasse 18-20","Landesgerichtsstra√üe 11","Schmerlingplatz 10-11","Stubenring 1"], correctAnswer:"Wickenburggasse 18-20", coordinates:[48.214,16.342] },
    { name:"Justiz-Zentrum Wien Mitte", question:"Wo befindet sich das Justiz-Zentrum Wien Mitte?", options:["Marxergasse 1a","Althanstra√üe 39-45","Schmerlingplatz 10-11","Stubenring 1"], correctAnswer:"Marxergasse 1a", coordinates:[48.206,16.390] },
    { name:"Arbeits- und Sozialgericht Wien", question:"Wo befindet sich das Arbeits- und Sozialgericht Wien?", options:["Althanstra√üe 39-45","Marxergasse 1a","Hernalser G√ºrtel 6-12","Stubenring 1"], correctAnswer:"Althanstra√üe 39-45", coordinates:[48.223,16.358] },
    { name:"Landesgerichtliches Gefangenenhaus II", question:"Wo befindet sich das Landesgerichtliches Gefangenenhaus II?", options:["Hernalser G√ºrtel 6-12","Wickenburggasse 18-20","Marxergasse 1a","Dr.-Karl-Renner-Ring 3"], correctAnswer:"Hernalser G√ºrtel 6-12", coordinates:[48.220,16.338] },
    { name:"Rechnungshof", question:"Wo befindet sich der Rechnungshof?", options:["Dampfschiffstra√üe 2","Judenplatz 11","Schmerlingplatz 10-11","Landesgerichtsstra√üe 11"], correctAnswer:"Dampfschiffstra√üe 2", coordinates:[48.207,16.392] }
  ],
  bundespolizei: [],
  stadtpolizei: [],
  post: [],
  medien: [],
  kammern: [],
  bezirksaemter: [],
  hotels: [],
  cafes: [],
  heurige: [],
  friedhoefe: [],
  kranken: [],
  pension: [],
  kultur: [],
  kabarett: [],
  unis: [],
  museen: [],
  guertel: [],
  bruecken: [],
  nummern: [],
  strassen: [],
  autobahnen: []
};

// --- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ---
let isRegister = false;
function toggleForm(register=false){
  isRegister = register;
  document.getElementById("formTitle").textContent = register ? "Register" : "Login";
  document.getElementById("loginPass2").style.display = register ? "block" : "none";
  document.getElementById("submitBtn").textContent = register ? "Register" : "Log in";
}
window.toggleForm = toggleForm;

async function submitForm(){
  const email = document.getElementById("loginEmail").value.trim();
  const pass1 = document.getElementById("loginPass").value.trim();
  const pass2 = document.getElementById("loginPass2").value.trim();
  try {
    if(isRegister){
      if(pass1 !== pass2){
        document.getElementById("loginError").textContent = "Passwords do not match!";
        return;
      }
      await createUserWithEmailAndPassword(auth, email, pass1);
      alert("‚úÖ Registration successful!");
    } else {
      await signInWithEmailAndPassword(auth, email, pass1);
      alert("‚úÖ Login successful!");
    }
    document.getElementById("loginModal").style.display = "none";
  } catch(err){
    document.getElementById("loginError").textContent = "‚ö†Ô∏è " + err.message;
  }
}
window.submitForm = submitForm;

// --- –ö–∞—Ä—Ç–∞ ---
const map = L.map('map').setView([48.2082,16.3738],13);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{ attribution:'¬© OpenStreetMap' }).addTo(map);

// --- –ú–µ–Ω—é ---
function toggleMenu(){
  const s = document.getElementById("sidebar");
  s.style.display = (s.style.display === "block") ? "none" : "block";
}
window.toggleMenu = toggleMenu;

// --- –õ–æ–≥–∏–∫–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã ---
let selectedCategories = [];
let currentQuestions = [];
let currentIndex = 0;
let score = 0;

function startMultiQuiz(){
  const checked = Array.from(document.querySelectorAll(".sidebar input[type=checkbox]:checked"))
                  .map(cb => cb.value);
  if(checked.length===0){ alert("Bitte Kategorie w√§hlen!"); return; }
  selectedCategories = checked;
  currentQuestions = [];
  checked.forEach(cat => currentQuestions.push(...quizData[cat]));
  currentIndex = 0;
  score = 0;
  document.getElementById("quizPanel").style.display = "block";
  document.getElementById("sidebar").style.display = "none";
  showQuestion();
}
window.startMultiQuiz = startMultiQuiz;

function showQuestion(){
  const q = currentQuestions[currentIndex];
  document.getElementById("progress").textContent = `Frage ${currentIndex+1} von ${currentQuestions.length}`;
  document.getElementById("questionText").textContent = q.question;
  const cont = document.getElementById("optionsContainer");
  cont.innerHTML = "";
  q.options.forEach(opt=>{
    const div=document.createElement("div");
    div.className="option";
    div.textContent=opt;
    div.onclick=()=>checkAnswer(div,opt);
    cont.appendChild(div);
  });
}
function checkAnswer(el,opt){
  const q=currentQuestions[currentIndex];
  if(opt===q.correctAnswer){ el.classList.add("correct"); score++; }
  else{ el.classList.add("incorrect"); }
  document.querySelectorAll(".option").forEach(o=>o.onclick=null);
  document.getElementById("nextBtn").style.display="block";
}
function nextQuestion(){
  currentIndex++;
  if(currentIndex<currentQuestions.length){
    document.getElementById("nextBtn").style.display="none";
    showQuestion();
  } else {
    document.getElementById("questionText").textContent=`Fertig! Punkte: ${score}/${currentQuestions.length}`;
    document.getElementById("optionsContainer").innerHTML="";
    document.getElementById("progress").textContent="";
    document.getElementById("nextBtn").style.display="none";
    document.getElementById("endBtns").style.display="block";
  }
}
window.nextQuestion = nextQuestion;

function restartQuiz(){
  document.getElementById("endBtns").style.display="none";
  startMultiQuiz();
}
window.restartQuiz = restartQuiz;
function backToMenu(){
  document.getElementById("quizPanel").style.display="none";
  document.getElementById("sidebar").style.display="block";
  document.getElementById("endBtns").style.display="none";
}
window.backToMenu = backToMenu;
</script>
</body>
</html>


