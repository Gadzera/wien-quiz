<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wiener Taxi Pr√ºfungsassistent</title>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
:root{
  --brand:#2563eb; --brand-2:#60a5fa;
  --ok:#16a34a; --err:#dc2626;
  --bg:#ffffff; --panel:#ffffff; --text:#0f172a; --muted:#6b7280;
  --chip:#f8fafc; --border:#e5e7eb;
  --shadow:0 10px 30px rgba(2,6,23,.15);
  --radius:14px;
}
@media (prefers-color-scheme: dark){
  :root{
    --bg:#0b1020; --panel:#0f172a; --text:#e5e7eb; --muted:#94a3b8;
    --chip:#0b1225; --border:#1f2937; --shadow:0 10px 40px rgba(0,0,0,.45);
  }
}
*{ box-sizing:border-box }
html,body{ height:100%; margin:0; background:var(--bg); color:var(--text); font-family:system-ui,Segoe UI,Roboto,sans-serif; }
#map{ position:fixed; inset:0; z-index:1; }

.topbar{
  position:fixed; top:12px; left:12px; right:12px; z-index:1001;
  display:flex; gap:8px; align-items:center; justify-content:flex-start;
  pointer-events:none;
}
.btn{ pointer-events:auto; border:none; padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer;
      color:white; background:linear-gradient(180deg,var(--brand),#1e40af); box-shadow:var(--shadow); margin-right: auto; }
.btn.secondary{ background:#334155; }
.iconbtn{ pointer-events:auto; border:none; border-radius:10px; padding:10px 12px; background:#111827; color:#fff; opacity:.9; cursor:pointer; }
.iconbtn:hover{ opacity:1; }
.spacer{ flex:1 }

.sidebar{
  position:fixed; top:64px; left:12px; z-index:1000; width:360px; max-height:78vh; overflow:auto;
  background:var(--panel); border:1px solid var(--border); border-radius:var(--radius); padding:14px; box-shadow:var(--shadow); display:block;
}
.sidebar h3{ margin:0 0 8px 0; }
.cat{ display:flex; align-items:center; gap:8px; padding:8px; margin:8px 0; background:var(--chip); border-left:4px solid var(--brand); border-radius:10px; }
.cat .count{ margin-left:auto; color:var(--muted); font-size:12px; }

.quiz-panel{
  position:fixed; top:64px; right:12px; z-index:1000; width:380px; max-height:78vh; overflow:auto;
  background:var(--panel); border:1px solid var(--border); border-radius:var(--radius); padding:16px; box-shadow:var(--shadow); display:none;
}
.question{ font-weight:700; margin:8px 0 10px; text-align:center; }
.progress{ text-align:center; font-size:13px; color:var(--muted); }
.progressbar{ height:8px; background:#e5e7eb; border-radius:999px; overflow:hidden; margin:8px 0 12px; }
.progressbar-fill{ height:100%; background:linear-gradient(90deg,var(--brand),var(--brand-2)); width:0%; transition:width .25s ease; }

.options{ display:grid; gap:8px; }
.option{ padding:12px; border:1px solid var(--border); border-radius:10px; cursor:pointer; background:transparent; }
.option:hover{ border-color:var(--brand); background:rgba(37,99,235,.07); }
.option.correct{ border-color:var(--ok); background:#f0fdf4; }
.option.incorrect{ border-color:var(--err); background:#fef2f2; }

.next-btn,.end-btn{ margin-top:10px; width:100%; font-weight:800; border:none; border-radius:10px; padding:10px 14px; color:white; background:linear-gradient(180deg,var(--brand),#1e40af); cursor:pointer; }
.end-btn.secondary{ background:#334155; }

.panel{
  position:fixed; top:64px; right:410px; z-index:1000; width:460px; max-height:78vh; overflow:auto;
  background:var(--panel); border:1px solid var(--border); border-radius:var(--radius); padding:16px; box-shadow:var(--shadow); display:none;
}
.panel h3{ margin:0 0 10px 0 }
.row{ display:flex; gap:10px; flex-wrap:wrap; }
.kbd{ font-family:ui-monospace,monospace; background:#111827; color:#fff; padding:2px 6px; border-radius:6px; }

.toast{
  position:fixed; bottom:16px; left:50%; transform:translateX(-50%) translateY(20px);
  background:rgba(17,24,39,.95); color:#fff; padding:10px 14px; border-radius:10px; box-shadow:var(--shadow);
  opacity:0; pointer-events:none; transition:opacity .25s, transform .25s; z-index:3000; font-size:13px;
}
.toast.show{ opacity:1; transform:translateX(-50%) translateY(0); }

/* G√ºrtel highlight */
.badge{ display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; font-weight:800; }
.badge-inner{ background:#0ea5e9; color:#fff; }
.badge-outer{ background:#f59e0b; color:#111; }
.small{ font-size:12px; color:var(--muted); }
hr{ border:none; border-top:1px solid var(--border); margin:10px 0; }

.stats-panel {
  background: var(--panel);
  padding: 15px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
}

.question-editor {
  background: var(--chip);
  padding: 15px;
  border-radius: var(--radius);
  margin: 10px 0;
  border: 1px solid var(--border);
}

.question-editor textarea, .question-editor input {
  width: 100%;
  padding: 8px;
  margin: 5px 0;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: var(--bg);
  color: var(--text);
}

.question-editor button {
  margin: 5px;
  padding: 8px 12px;
  border: none;
  border-radius: 8px;
  background: var(--brand);
  color: white;
  cursor: pointer;
}

/* Map markers */
.marker-correct {
  background-color: #16a34a;
  border: 3px solid #fff;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}

.marker-incorrect {
  background-color: #dc2626;
  border: 3px solid #fff;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}

.marker-question {
  background-color: #2563eb;
  border: 3px solid #fff;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}
</style>
</head>
<body>

<div id="map"></div>

<!-- Topbar -->
<div class="topbar">
  <button class="btn" id="menuBtn" style="margin-left: 120px;">‚ò∞ Themen</button>
  <div class="spacer"></div>
  <button class="iconbtn" id="studyBtn" title="–£—á–µ–±–Ω—ã–π —Ä–µ–∂–∏–º G√ºrtel">üß≠ G√ºrtel</button>
  <button class="iconbtn" id="editBtn" title="–†–µ–¥–∞–∫—Ç–æ—Ä –≤–æ–ø—Ä–æ—Å–æ–≤">‚úèÔ∏è</button>
  <button class="iconbtn" id="statsBtn" title="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞">üìä</button>
  <button class="iconbtn" id="ttsToggleBtn" title="–û–∑–≤—É—á–∫–∞ –≤–∫–ª/–≤—ã–∫–ª">üîä</button>
</div>

<!-- Sidebar: Kategorien -->
<div class="sidebar" id="sidebar">
  <h3>üóÇÔ∏è Themen (I. ORTSKUNDE ‚Äì 23 Kapitel aus dem PDF)</h3>
  <div id="catList"></div>
  <button id="startBtn" class="btn" style="margin-top:10px;width:100%;">‚ñ∂Ô∏è Quiz starten</button>
  <button id="examBtn" class="btn secondary" style="margin-top:8px;width:100%;">üìù Pr√ºfungsmodus (10 Fragen)</button>
  <p class="small" style="margin-top:8px">Hotkeys: <span class="kbd">1..6</span> f√ºr Antworten, <span class="kbd">Enter</span> = Weiter.</p>
</div>

<!-- Quiz Panel -->
<div class="quiz-panel" id="quizPanel" aria-live="polite">
  <div class="progress" id="progress"></div>
  <div class="progressbar"><div class="progressbar-fill" id="progressFill"></div></div>
  <div class="question" id="questionText"></div>
  <div class="options" id="optionsContainer"></div>
  <button class="next-btn" id="nextBtn" style="display:none;">Weiter ‚Üí</button>
  <div id="endBtns" style="display:none;">
    <button class="end-btn" id="againBtn">üîÑ Nochmal spielen</button>
    <button class="end-btn secondary" id="backBtn">üìñ Zur√ºck</button>
  </div>
</div>

<!-- Panel: G√ºrtel Study -->
<div class="panel" id="studyPanel">
  <h3>üß≠ –£—á–µ–±–Ω—ã–π —Ä–µ–∂–∏–º: G√ºrtel</h3>
  <p class="small">–ö–ª–∏–∫ –ø–æ —Å—Ç—Ä–æ–∫–µ ‚Äî –∫–∞—Ä—Ç–∞ –ø–æ–∫–∞–∂–µ—Ç –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–æ–∫.</p>
  <div id="studyList"></div>
</div>

<!-- Panel: Question Editor -->
<div class="panel" id="editPanel">
  <h3>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä –≤–æ–ø—Ä–æ—Å–æ–≤</h3>
  <div class="question-editor">
    <select id="categorySelect">
      <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
    </select>
    <input type="text" id="questionName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞">
    <textarea id="questionTextEdit" placeholder="–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞"></textarea>
    <input type="text" id="option1" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 1">
    <input type="text" id="option2" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 2">
    <input type="text" id="option3" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 3">
    <input type="text" id="option4" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 4">
    <input type="text" id="option5" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 5">
    <input type="text" id="option6" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 6">
    <select id="correctAnswer">
      <option value="">–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç</option>
      <option value="0">–í–∞—Ä–∏–∞–Ω—Ç 1</option>
      <option value="1">–í–∞—Ä–∏–∞–Ω—Ç 2</option>
      <option value="2">–í–∞—Ä–∏–∞–Ω—Ç 3</option>
      <option value="3">–í–∞—Ä–∏–∞–Ω—Ç 4</option>
      <option value="4">–í–∞—Ä–∏–∞–Ω—Ç 5</option>
      <option value="5">–í–∞—Ä–∏–∞–Ω—Ç 6</option>
    </select>
    <button id="saveQuestion">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–æ–ø—Ä–æ—Å</button>
    <button id="loadDefault" class="secondary">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã</button>
  </div>
</div>

<!-- Panel: Stats -->
<div class="panel" id="statsPanel">
  <h3>üìä –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
  <div class="stats-panel" id="myStats">
    <p>–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: <span id="correctCount">0</span> –∏–∑ <span id="totalCount">0</span></p>
    <p>–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö: <span id="accuracy">0%</span></p>
    <button class="btn secondary" id="resetStats" style="margin-top:10px;">–°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
// ============ DATA ============
// –ö–ª—é—á ElevenLabs –∏ –≥–æ–ª–æ—Å
const ELEVEN_API_KEY = "YOUR_ELEVENLABS_API_KEY_HERE"; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –∫–ª—é—á
const ELEVEN_VOICE_ID = "ROYWaqtov1Lot9vQBM3y";

// 23 —Ç–µ–º—ã I. ORTSKUNDE
const THEMEN = [
 {key:"regierungs", title:"1) Regierungsgeb√§ude", pages:"S.6"},
 {key:"gerichte",   title:"2) Gerichtsgeb√§ude", pages:"S.6‚Äì7"},
 {key:"bundespolizei", title:"3) Bundespolizeidirektion Wien", pages:"S.7"},
 {key:"stadtpolizei",  title:"4) Stadtpolizeikommanden / Polizeiinspektionen", pages:"S.7‚Äì10"},
 {key:"post", title:"5) Post", pages:"S.6"},
 {key:"medien", title:"6) Massenmedien", pages:"S.36 (APA) etc."},
 {key:"kammern", title:"7) Kammern", pages:"(WKO etc.)"},
 {key:"bezirksaemter", title:"8) Magistratische Bezirks√§mter (Amtsh√§user)", pages:"S.8‚Äì9"},
 {key:"hotels", title:"9) Beherbergungsbetriebe / Hotels (Auswahl)", pages:"S.10‚Äì13"},
 {key:"cafes", title:"10) Kaffeeh√§user", pages:"S.14"},
 {key:"heurige", title:"11) Bezirksnamen & Heurigenorte", pages:"S.15‚Äì16"},
 {key:"friedhoefe", title:"12) Friedh√∂fe", pages:"S.16‚Äì18"},
 {key:"kranken", title:"13) Krankenanstalten", pages:"S.17‚Äì19"},
 {key:"pension", title:"14) Pensionistenwohnheime", pages:"S.19"},
 {key:"kultur",  title:"15) Kulturinstitute / B√ºhnenh√§user", pages:"S.19"},
 {key:"kabarett",title:"15a) Kabaretts, Volksb√ºhnen", pages:"S.19"},
 {key:"unis",   title:"16) Universit√§ten / Bildungsanstalten", pages:"S.20"},
 {key:"museen", title:"17) Museen", pages:"S.20‚Äì22"},
 {key:"bauten", title:"18) Bauten, Sehensw√ºrdigkeiten, Hotels & Caf√©s", pages:"S.21‚Äì22"},
 {key:"guertel",title:"19) Nach dem G√úRTEL √ºberquert + G√ºrtelseiten", pages:"S.23 & S.27"},
 {key:"donau",  title:"20) Nach Br√ºcken √ºber DONAUKANAL/DONAU", pages:"S.24"},
 {key:"nummern",title:"21) Nummerierungssystem", pages:"S.24"},
 {key:"strassgeo", title:"22) Stra√üengeographie (Allgemein)", pages:"S.25"},
 {key:"wichtige", title:"23) Wichtige Stra√üen und Autobahnen", pages:"S.26"},
 // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:
 {key:"tarif", title:"Wiener Tarif (zus√§tzlich)", pages:"S.58‚Äì61"},
 {key:"stvo",  title:"StVO (Auszug f√ºr Taxi)", pages:"S.62‚Äì75"},
 {key:"kfg",   title:"KFG (Kraftfahrgesetz) ‚Äì Pflichtfragen", pages:"S.76‚Äì80"},
 {key:"arbeit",title:"Arbeits- und Sozialrecht", pages:"S.84‚Äì95"}
];

// –ü–û–õ–ù–´–ï –í–û–ü–†–û–°–´ –î–õ–Ø –í–°–ï–• –¢–ï–ú –° –ü–†–û–í–ï–†–ï–ù–ù–´–ú–ò –ö–û–û–†–î–ò–ù–ê–¢–ê–ú–ò
const DEFAULT_QUESTIONS = {
  regierungs: [
    { name:"Parlament", question:"Wo befindet sich das Parlament?", options:["Dr.-Karl-Renner-Ring 3","Ballhausplatz 2","Minoritenplatz 5","Stubenring 1","Herrengasse 7","Johannesgasse 5"], correct:0, coords:[48.2079,16.3593] },
    { name:"Bundeskanzleramt", question:"Wo befindet sich das Bundeskanzleramt?", options:["Ballhausplatz 2","Herrengasse 7","Johannesgasse 5","Stubenring 1","Minoritenplatz 3","Rathausplatz 1"], correct:0, coords:[48.2084,16.3637] },
    { name:"Rathaus", question:"Wo befindet sich das Rathaus?", options:["Rathausplatz 1","Stubenring 1","Johannesgasse 5","Minoritenplatz 8","Ballhausplatz 1","Dr.-Karl-Renner-Ring 3"], correct:0, coords:[48.2105,16.3562] },
    { name:"Pr√§sidentschaftskanzlei", question:"Wo befindet sich die Pr√§sidentschaftskanzlei?", options:["Ballhausplatz 1","Herrengasse 7","Johannesgasse 5","Stubenring 1","Minoritenplatz 3","Rathausplatz 1"], correct:0, coords:[48.2081,16.3640] },
    { name:"BM Inneres", question:"Wo befindet sich das BM f√ºr Inneres?", options:["Herrengasse 7","Johannesgasse 5","Stubenring 1","Ballhausplatz 2","Minoritenplatz 3","Rathausplatz 1"], correct:0, coords:[48.2093,16.3659] },
    { name:"BM Justiz", question:"Wo befindet sich das BM f√ºr Justiz?", options:["Museumstra√üe 7","Herrengasse 7","Johannesgasse 5","Stubenring 1","Ballhausplatz 2","Minoritenplatz 3"], correct:0, coords:[48.2058,16.3551] },
    { name:"BM Finanzen", question:"Wo befindet sich das BM f√ºr Finanzen?", options:["Johannesgasse 5","Herrengasse 7","Museumstra√üe 7","Stubenring 1","Ballhausplatz 2","Minoritenplatz 3"], correct:0, coords:[48.2090,16.3790] },
    { name:"BM Bildung", question:"Wo befindet sich das BM f√ºr Bildung?", options:["Minoritenplatz 5","Johannesgasse 5","Herrengasse 7","Museumstra√üe 7","Stubenring 1","Ballhausplatz 2"], correct:0, coords:[48.2095,16.3630] }
  ],
  gerichte: [
    { name:"OGH", question:"Wo befindet sich der Oberste Gerichtshof?", options:["Schmerlingplatz 10-11","Landesgerichtsstra√üe 11","Herrengasse 7","Ballhausplatz 1","Freyung 8","Judenplatz 11"], correct:0, coords:[48.2095,16.3585] },
    { name:"Verfassungsgerichtshof", question:"Wo befindet sich der Verfassungsgerichtshof?", options:["Freyung 8","Judenplatz 11","Schmerlingplatz 10-11","Stubenring 1","Ballhausplatz 2","Landesgerichtsstra√üe 11"], correct:0, coords:[48.2115,16.3655] },
    { name:"Verwaltungsgerichtshof", question:"Wo befindet sich der Verwaltungsgerichtshof?", options:["Judenplatz 11","Freyung 8","Schmerlingplatz 10-11","Stubenring 1","Ballhausplatz 2","Landesgerichtsstra√üe 11"], correct:0, coords:[48.2110,16.3690] },
    { name:"Landesgericht Strafsachen", question:"Wo befindet sich das Landesgericht f√ºr Strafsachen?", options:["Landesgerichtsstra√üe 11","Schmerlingplatz 10-11","Herrengasse 7","Ballhausplatz 1","Freyung 8","Judenplatz 11"], correct:0, coords:[48.2150,16.3500] },
    { name:"Rechnungshof", question:"Wo befindet sich der Rechnungshof?", options:["Dampfschiffstra√üe 2","Judenplatz 11","Schmerlingplatz 10-11","Landesgerichtsstra√üe 11","Freyung 8","Ballhausplatz 1"], correct:0, coords:[48.2070,16.3920] },
    { name:"Handelsgericht", question:"Wo befindet sich das Handelsgericht?", options:["Marxergasse 1B","Dampfschiffstra√üe 2","Judenplatz 11","Schmerlingplatz 10-11","Landesgerichtsstra√üe 11","Freyung 8"], correct:0, coords:[48.2080,16.3840] }
  ],
  bundespolizei: [
    { name:"Sicherheitsb√ºro BPD Wien", question:"Wo befindet sich das Sicherheitsb√ºro der BPD Wien?", options:["Schottenring 7-9","Hernalser G√ºrtel 6-12","Dierichgasse 27","Laxenburger Stra√üe 36","Wipplingerstra√üe 34","Mariahilfer Stra√üe 1"], correct:0, coords:[48.2180,16.3630] },
    { name:"Fremdenpolizei", question:"Wo befindet sich das Fremdenpolizeiliche B√ºro?", options:["Hernalser G√ºrtel 6-12","Schottenring 7-9","Dierichgasse 27","Wipplingerstra√üe 34","Laxenburger Stra√üe 36","Mariahilfer Stra√üe 1"], correct:0, coords:[48.2189,16.3375] },
    { name:"Verkehrsamt", question:"Wo befindet sich das Verkehrsamt (F√ºhrerschein/Taxilenker)?", options:["Dierichgasse 27","Schottenring 7-9","Hernalser G√ºrtel 6-12","Wagramer Stra√üe 5","Laxenburger Stra√üe 36","Mariahilfer Stra√üe 1"], correct:0, coords:[48.1929,16.4075] },
    { name:"Bundespolizeidirektion", question:"Wo ist die Bundespolizeidirektion Wien?", options:["Schottenring 7-9","Hernalser G√ºrtel 6-12","Dierichgasse 27","Laxenburger Stra√üe 36","Wipplingerstra√üe 34","Mariahilfer Stra√üe 1"], correct:0, coords:[48.2180,16.3630] }
  ],
  stadtpolizei: [
    { name:"PI Innere Stadt", question:"Wo liegt die PI Innere Stadt?", options:["Deutschmeisterplatz 3","Mariahilfer Stra√üe 1","Landesgerichtsstra√üe 11","Herrengasse 7","Schottenring 7-9","Ballhausplatz 1"], correct:0, coords:[48.2146,16.3777] },
    { name:"PI Mariahilf", question:"PI Mariahilf ‚Äì wo?", options:["Amerlingstra√üe 33","Sch√∂nbrunner Stra√üe 59","Landstra√üer Hauptstra√üe 29","Nu√üdorfer Stra√üe 28","Mariahilfer Stra√üe 1","Gumpendorfer Stra√üe 1"], correct:0, coords:[48.1969,16.3483] },
    { name:"PI Landstra√üe", question:"Wo befindet sich die PI Landstra√üe?", options:["Landstra√üer Hauptstra√üe 29","Amerlingstra√üe 33","Sch√∂nbrunner Stra√üe 59","Nu√üdorfer Stra√üe 28","Mariahilfer Stra√üe 1","Gumpendorfer Stra√üe 1"], correct:0, coords:[48.1910,16.3910] },
    { name:"PI Wieden", question:"Wo befindet sich die PI Wieden?", options:["Favoritenstra√üe 1","Amerlingstra√üe 33","Sch√∂nbrunner Stra√üe 59","Landstra√üer Hauptstra√üe 29","Mariahilfer Stra√üe 1","Gumpendorfer Stra√üe 1"], correct:0, coords:[48.1900,16.3700] },
    { name:"PI Margareten", question:"Wo befindet sich die PI Margareten?", options:["Strohgasse 7-9","Favoritenstra√üe 1","Amerlingstra√üe 33","Sch√∂nbrunner Stra√üe 59","Landstra√üer Hauptstra√üe 29","Mariahilfer Stra√üe 1"], correct:0, coords:[48.1880,16.3550] },
    { name:"PI Favoriten", question:"Wo befindet sich die PI Favoriten?", options:["Quellenstra√üe 51","Strohgasse 7-9","Favoritenstra√üe 1","Amerlingstra√üe 33","Sch√∂nbrunner Stra√üe 59","Landstra√üer Hauptstra√üe 29"], correct:0, coords:[48.1730,16.3820] }
  ],
  post: [
    { name:"Hauptpost", question:"Wo befindet sich die Hauptpost?", options:["Fleischmarkt 19","Herrengasse 7","Schwedenplatz 2","K√§rntner Stra√üe 1","Mariahilfer Stra√üe 1","Ballhausplatz 1"], correct:0, coords:[48.2090,16.3750] },
    { name:"Postamt 1010", question:"Wo befindet sich das Postamt 1010?", options:["Wipplingerstra√üe 32","Fleischmarkt 19","Herrengasse 7","Schwedenplatz 2","K√§rntner Stra√üe 1","Mariahilfer Stra√üe 1"], correct:0, coords:[48.2130,16.3670] },
    { name:"Postamt 1070", question:"Wo befindet sich das Postamt 1070?", options:["Kaiserstra√üe 55","Wipplingerstra√üe 32","Fleischmarkt 19","Herrengasse 7","Schwedenplatz 2","K√§rntner Stra√üe 1"], correct:0, coords:[48.2020,16.3500] },
    { name:"Postamt 1150", question:"Wo befindet sich das Postamt 1150?", options:["Mariahilfer Stra√üe 84","Kaiserstra√üe 55","Wipplingerstra√üe 32","Fleischmarkt 19","Herrengasse 7","Schwedenplatz 2"], correct:0, coords:[48.1900,16.3380] }
  ],
  medien: [
    { name:"APA", question:"Wo befindet sich APA (IPZ) / Media Print?", options:["Lassallestra√üe 89","Kirchengasse 1","Schottenring 10","K√§rntner Ring 5","Mariahilfer Stra√üe 1","Ballhausplatz 1"], correct:0, coords:[48.2240,16.4150] },
    { name:"ORF", question:"Wo befindet sich der ORF?", options:["W√ºrzburggasse 30","Lassallestra√üe 89","Kirchengasse 1","Schottenring 10","K√§rntner Ring 5","Mariahilfer Stra√üe 1"], correct:0, coords:[48.1920,16.3330] },
    { name:"Kronen Zeitung", question:"Wo befindet sich die Kronen Zeitung?", options:["Lassallestra√üe 26","W√ºrzburggasse 30","Lassallestra√üe 89","Kirchengasse 1","Schottenring 10","K√§rntner Ring 5"], correct:0, coords:[48.2250,16.4100] },
    { name:"Der Standard", question:"Wo befindet sich Der Standard?", options:["Herrengasse 1","Lassallestra√üe 26","W√ºrzburggasse 30","Lassallestra√üe 89","Kirchengasse 1","Schottenring 10"], correct:0, coords:[48.2100,16.3660] }
  ],
  kammern: [
    { name:"Wirtschaftskammer", question:"Wo befindet sich die WKO Wien?", options:["Stubenring 8-10","Getreidemarkt 10","Mariahilfer Stra√üe 123","Am Heumarkt 4","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2058,16.3797] },
    { name:"√Ñrztekammer", question:"Wo befindet sich die √Ñrztekammer?", options:["Weihburggasse 10-12","Stubenring 8-10","Getreidemarkt 10","Mariahilfer Stra√üe 123","Am Heumarkt 4","Ballhausplatz 1"], correct:0, coords:[48.2040,16.3770] },
    { name:"Apothekerkammer", question:"Wo befindet sich die Apothekerkammer?", options:["Spitalgasse 31","Weihburggasse 10-12","Stubenring 8-10","Getreidemarkt 10","Mariahilfer Stra√üe 123","Am Heumarkt 4"], correct:0, coords:[48.2170,16.3550] },
    { name:"Rechtsanwaltskammer", question:"Wo befindet sich die Rechtsanwaltskammer?", options:["Rotenturmstra√üe 13","Spitalgasse 31","Weihburggasse 10-12","Stubenring 8-10","Getreidemarkt 10","Mariahilfer Stra√üe 123"], correct:0, coords:[48.2100,16.3750] }
  ],
  bezirksaemter: [
    { name:"Bezirksamt 1", question:"Amtshaus des 1. Bezirks liegt ‚Ä¶", options:["Wipplingerstra√üe 8","Rathausplatz 1","Schottenring 10","Freyung 8","Ballhausplatz 1","Stubenring 1"], correct:0, coords:[48.2134,16.3686] },
    { name:"Bezirksamt 6", question:"Amtshaus des 6. Bezirks liegt ‚Ä¶", options:["Gumpendorfer Stra√üe 1","Wipplingerstra√üe 8","Rathausplatz 1","Schottenring 10","Freyung 8","Ballhausplatz 1"], correct:0, coords:[48.1960,16.3500] },
    { name:"Bezirksamt 7", question:"Amtshaus des 7. Bezirks liegt ‚Ä¶", options:["Hermanngasse 24-26","Gumpendorfer Stra√üe 1","Wipplingerstra√üe 8","Rathausplatz 1","Schottenring 10","Freyung 8"], correct:0, coords:[48.2030,16.3500] },
    { name:"Bezirksamt 8", question:"Amtshaus des 8. Bezirks liegt ‚Ä¶", options:["Lange Gasse 37","Hermanngasse 24-26","Gumpendorfer Stra√üe 1","Wipplingerstra√üe 8","Rathausplatz 1","Schottenring 10"], correct:0, coords:[48.2100,16.3480] },
    { name:"Bezirksamt 9", question:"Amtshaus des 9. Bezirks liegt ‚Ä¶", options:["W√§hringer Stra√üe 43","Lange Gasse 37","Hermanngasse 24-26","Gumpendorfer Stra√üe 1","Wipplingerstra√üe 8","Rathausplatz 1"], correct:0, coords:[48.2200,16.3570] }
  ],
  hotels: [
    { name:"Hotel Sacher", question:"Wo befindet sich das Hotel Sacher?", options:["Philharmonikerstra√üe 4","K√§rntner Ring 1","Am Heumarkt 35-37","Albertinaplatz 1","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2039,16.3692] },
    { name:"Hilton Vienna Park", question:"Wo befindet sich Hilton Vienna Park?", options:["Am Stadtpark 1","Wagramer Stra√üe 8","Schottenring 1","Landstra√üer G√ºrtel 2","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2055,16.3828] },
    { name:"Hotel Imperial", question:"Wo befindet sich das Hotel Imperial?", options:["K√§rntner Ring 16","Am Stadtpark 1","Wagramer Stra√üe 8","Schottenring 1","Landstra√üer G√ºrtel 2","Ballhausplatz 1"], correct:0, coords:[48.2025,16.3675] },
    { name:"Hotel Bristol", question:"Wo befindet sich das Hotel Bristol?", options:["K√§rntner Ring 1","Am Stadtpark 1","Wagramer Stra√üe 8","Schottenring 1","Landstra√üer G√ºrtel 2","Ballhausplatz 1"], correct:0, coords:[48.2030,16.3720] },
    { name:"Hotel InterContinental", question:"Wo befindet sich das Hotel InterContinental?", options:["Johannesgasse 28","K√§rntner Ring 1","Am Stadtpark 1","Wagramer Stra√üe 8","Schottenring 1","Landstra√üer G√ºrtel 2"], correct:0, coords:[48.2070,16.3790] },
    { name:"Hotel Marriott", question:"Wo befindet sich das Hotel Marriott?", options:["Parkring 12A","Johannesgasse 28","K√§rntner Ring 1","Am Stadtpark 1","Wagramer Stra√üe 8","Schottenring 1"], correct:0, coords:[48.2080,16.3800] }
  ],
  cafes: [
    { name:"Caf√© Central", question:"Caf√© Central liegt ‚Ä¶", options:["Herrengasse 14","Rathausplatz 1","Judenplatz 11","Albertinaplatz 1","Ballhausplatz 1","Stubenring 1"], correct:0, coords:[48.2108,16.3653] },
    { name:"Caf√© Landtmann", question:"Caf√© Landtmann liegt ‚Ä¶", options:["Universit√§tsring 4","Opernring 2","K√§rntner Stra√üe 10","Schwarzenbergplatz 1","Ballhausplatz 1","Stubenring 1"], correct:0, coords:[48.2107,16.3604] },
    { name:"Caf√© Demel", question:"Caf√© Demel liegt ‚Ä¶", options:["Kohlmarkt 14","Universit√§tsring 4","Opernring 2","K√§rntner Stra√üe 10","Schwarzenbergplatz 1","Ballhausplatz 1"], correct:0, coords:[48.2085,16.3675] },
    { name:"Caf√© Hawelka", question:"Caf√© Hawelka liegt ‚Ä¶", options:["Dorotheergasse 6","Kohlmarkt 14","Universit√§tsring 4","Opernring 2","K√§rntner Stra√üe 10","Schwarzenbergplatz 1"], correct:0, coords:[48.2080,16.3685] },
    { name:"Caf√© Museum", question:"Caf√© Museum liegt ‚Ä¶", options:["Operngasse 7","Dorotheergasse 6","Kohlmarkt 14","Universit√§tsring 4","Opernring 2","K√§rntner Stra√üe 10"], correct:0, coords:[48.2030,16.3670] },
    { name:"Caf√© Sacher", question:"Caf√© Sacher liegt ‚Ä¶", options:["Philharmonikerstra√üe 4","Operngasse 7","Dorotheergasse 6","Kohlmarkt 14","Universit√§tsring 4","Opernring 2"], correct:0, coords:[48.2039,16.3692] }
  ],
  heurige: [
    { name:"Heurigenort 19", question:"Zum 19. Bezirk geh√∂rt als Heurigenort ‚Ä¶", options:["Grinzing","Stammersdorf","Sievering","Jedlesee","Heiligenstadt","Nussdorf"], correct:0, coords:[48.2594,16.3359] },
    { name:"Heurigenort 21", question:"Zum 21. Bezirk geh√∂rt als Heurigenort ‚Ä¶", options:["Stammersdorf","Grinzing","Sievering","Jedlesee","Heiligenstadt","Nussdorf"], correct:0, coords:[48.3060,16.4140] },
    { name:"Heurigenort 22", question:"Zum 22. Bezirk geh√∂rt als Heurigenort ‚Ä¶", options:["Jedlesee","Grinzing","Stammersdorf","Sievering","Heiligenstadt","Nussdorf"], correct:0, coords:[48.2780,16.3920] },
    { name:"Heurigenort 19b", question:"Welcher Heurigenort liegt im 19. Bezirk?", options:["Sievering","Stammersdorf","Jedlesee","Kagran","Essling","Aspern"], correct:0, coords:[48.2480,16.3200] },
    { name:"Heurigenort 21b", question:"Welcher Heurigenort liegt im 21. Bezirk?", options:["Stammersdorf","Grinzing","Sievering","Jedlesee","Kagran","Essling"], correct:0, coords:[48.3060,16.4140] }
  ],
  friedhoefe: [
    { name:"Zentralfriedhof", question:"Wo befindet sich der Haupteingang (Tor 2)?", options:["Simmeringer Hauptstra√üe 234","W√§hringer G√ºrtel 14","Laxenburger Stra√üe 365","Hernalser G√ºrtel 6-12","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.1528,16.4337] },
    { name:"Friedhof St. Marx", question:"Wo befindet sich der Friedhof St. Marx?", options:["Leberstra√üe 6-8","Simmeringer Hauptstra√üe 234","W√§hringer G√ºrtel 14","Laxenburger Stra√üe 365","Hernalser G√ºrtel 6-12","Ballhausplatz 1"], correct:0, coords:[48.1820,16.4020] },
    { name:"Friedhof Hietzing", question:"Wo befindet sich der Friedhof Hietzing?", options:["Maxingstra√üe 15","Leberstra√üe 6-8","Simmeringer Hauptstra√üe 234","W√§hringer G√ºrtel 14","Laxenburger Stra√üe 365","Hernalser G√ºrtel 6-12"], correct:0, coords:[48.1870,16.2960] },
    { name:"Friedhof Neustift", question:"Wo befindet sich der Friedhof Neustift?", options:["Neustift am Walde 68","Maxingstra√üe 15","Leberstra√üe 6-8","Simmeringer Hauptstra√üe 234","W√§hringer G√ºrtel 14","Laxenburger Stra√üe 365"], correct:0, coords:[48.2480,16.2950] },
    { name:"Friedhof D√∂bling", question:"Wo befindet sich der Friedhof D√∂bling?", options:["Grinzinger Stra√üe 82","Neustift am Walde 68","Maxingstra√üe 15","Leberstra√üe 6-8","Simmeringer Hauptstra√üe 234","W√§hringer G√ºrtel 14"], correct:0, coords:[48.2520,16.3450] }
  ],
  kranken: [
    { name:"AKH Wien", question:"Wo befindet sich das AKH?", options:["W√§hringer G√ºrtel 18-20","Landstra√üer Hauptstra√üe 1","Sch√∂nbrunner Stra√üe 100","K√§rntner Ring 1","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2202,16.3451] },
    { name:"SMZ S√ºd", question:"Adresse des SMZ S√ºd?", options:["Kundratstra√üe 3","Prinzenstra√üe 1","Spitalgasse 23","Sechshauser Stra√üe 10","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.1589,16.3702] },
    { name:"Rudolfinerhaus", question:"Wo befindet sich das Rudolfinerhaus?", options:["Billrothstra√üe 78","Kundratstra√üe 3","Prinzenstra√üe 1","Spitalgasse 23","Sechshauser Stra√üe 10","Ballhausplatz 1"], correct:0, coords:[48.2330,16.3500] },
    { name:"Krankenhaus Hietzing", question:"Wo befindet sich das Krankenhaus Hietzing?", options:["Wolkersbergenstra√üe 1","Billrothstra√üe 78","Kundratstra√üe 3","Prinzenstra√üe 1","Spitalgasse 23","Sechshauser Stra√üe 10"], correct:0, coords:[48.1780,16.2600] },
    { name:"Krankenhaus Lainz", question:"Wo befindet sich das Krankenhaus Lainz?", options:["Wolkersbergenstra√üe 1","Billrothstra√üe 78","Kundratstra√üe 3","Prinzenstra√üe 1","Spitalgasse 23","Sechshauser Stra√üe 10"], correct:0, coords:[48.1680,16.2780] },
    { name:"Krankenhaus Nord", question:"Wo befindet sich das Krankenhaus Nord?", options:["Br√ºnner Stra√üe 1","Wolkersbergenstra√üe 1","Billrothstra√üe 78","Kundratstra√üe 3","Prinzenstra√üe 1","Spitalgasse 23"], correct:0, coords:[48.2780,16.4000] }
  ],
  pension: [
    { name:"Pensionistenwohnheim 9", question:"Wohnheim in der Seegasse liegt im ‚Ä¶", options:["9. Bezirk","3. Bezirk","15. Bezirk","22. Bezirk","1. Bezirk","7. Bezirk"], correct:0, coords:[48.2217,16.3617] },
    { name:"Pensionistenwohnheim 16", question:"Wohnheim in der Herbststra√üe liegt im ‚Ä¶", options:["16. Bezirk","9. Bezirk","3. Bezirk","15. Bezirk","22. Bezirk","1. Bezirk"], correct:0, coords:[48.2180,16.3080] },
    { name:"Pensionistenwohnheim 18", question:"Wohnheim in der Gentzgasse liegt im ‚Ä¶", options:["18. Bezirk","16. Bezirk","9. Bezirk","3. Bezirk","15. Bezirk","22. Bezirk"], correct:0, coords:[48.2250,16.3200] },
    { name:"Pensionistenwohnheim 10", question:"Wohnheim in der Laxenburger Stra√üe liegt im ‚Ä¶", options:["10. Bezirk","18. Bezirk","16. Bezirk","9. Bezirk","3. Bezirk","15. Bezirk"], correct:0, coords:[48.1650,16.3700] }
  ],
  kultur: [
    { name:"Burgtheater", question:"Adresse vom Burgtheater?", options:["Universit√§tsring 2","Opernring 2","K√§rntner Stra√üe 1","Schottenring 10","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2105,16.3600] },
    { name:"Staatsoper", question:"Adresse von der Staatsoper?", options:["Opernring 2","Universit√§tsring 2","K√§rntner Stra√üe 1","Schottenring 10","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2035,16.3692] },
    { name:"Volksoper", question:"Adresse von der Volksoper?", options:["W√§hringer Stra√üe 78","Opernring 2","Universit√§tsring 2","K√§rntner Stra√üe 1","Schottenring 10","Ballhausplatz 1"], correct:0, coords:[48.2300,16.3500] },
    { name:"Konzerthaus", question:"Adresse vom Konzerthaus?", options:["Lothringerstra√üe 20","W√§hringer Stra√üe 78","Opernring 2","Universit√§tsring 2","K√§rntner Stra√üe 1","Schottenring 10"], correct:0, coords:[48.2005,16.3760] },
    { name:"Theater an der Wien", question:"Adresse vom Theater an der Wien?", options:["Linke Wienzeile 6","Lothringerstra√üe 20","W√§hringer Stra√üe 78","Opernring 2","Universit√§tsring 2","K√§rntner Stra√üe 1"], correct:0, coords:[48.1990,16.3540] },
    { name:"Raimund Theater", question:"Adresse vom Raimund Theater?", options:["Wallgasse 18-20","Linke Wienzeile 6","Lothringerstra√üe 20","W√§hringer Stra√üe 78","Opernring 2","Universit√§tsring 2"], correct:0, coords:[48.1970,16.3380] }
  ],
  kabarett: [
    { name:"Kabarett Simpl", question:"Wo ist das Kabarett Simpl?", options:["Wollzeile 36","Mariahilfer Stra√üe 99","Donaukanalstra√üe 1","Herrengasse 14","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2079,16.3772] },
    { name:"Kabarett Niedermair", question:"Wo ist das Kabarett Niedermair?", options:["Laudongasse 36","Wollzeile 36","Mariahilfer Stra√üe 99","Donaukanalstra√üe 1","Herrengasse 14","Ballhausplatz 1"], correct:0, coords:[48.2130,16.3520] },
    { name:"Kabarett Vindobona", question:"Wo ist das Kabarett Vindobona?", options:["Walfischgasse 4","Laudongasse 36","Wollzeile 36","Mariahilfer Stra√üe 99","Donaukanalstra√üe 1","Herrengasse 14"], correct:0, coords:[48.2040,16.3680] },
    { name:"Kabarett Stadl", question:"Wo ist das Kabarett Stadl?", options:["Hernalser Hauptstra√üe 55","Walfischgasse 4","Laudongasse 36","Wollzeile 36","Mariahilfer Stra√üe 99","Donaukanalstra√üe 1"], correct:0, coords:[48.2230,16.3300] }
  ],
  unis: [
    { name:"Universit√§t Wien", question:"Adresse der Universit√§t Wien?", options:["Universit√§tsring 1","Karlsplatz 13","Schottenring 8","Schillerplatz 3","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2130,16.3607] },
    { name:"TU Wien", question:"Adresse der Technischen Universit√§t Wien?", options:["Karlsplatz 13","Universit√§tsring 1","W√§hringer Stra√üe 25","Schottenring 10","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.1995,16.3690] },
    { name:"Wirtschaftsuniversit√§t", question:"Adresse der Wirtschaftsuniversit√§t?", options:["Welthandelsplatz 1","Karlsplatz 13","Universit√§tsring 1","W√§hringer Stra√üe 25","Schottenring 10","Ballhausplatz 1"], correct:0, coords:[48.2135,16.4160] },
    { name:"Medizinische Universit√§t", question:"Adresse der Medizinischen Universit√§t?", options:["Spitalgasse 23","Welthandelsplatz 1","Karlsplatz 13","Universit√§tsring 1","W√§hringer Stra√üe 25","Schottenring 10"], correct:0, coords:[48.2200,16.3500] },
    { name:"Universit√§t f√ºr Musik", question:"Adresse der Universit√§t f√ºr Musik?", options:["Anton-von-Webern-Platz 1","Spitalgasse 23","Welthandelsplatz 1","Karlsplatz 13","Universit√§tsring 1","W√§hringer Stra√üe 25"], correct:0, coords:[48.1980,16.3690] },
    { name:"Akademie der bildenden K√ºnste", question:"Adresse der Akademie der bildenden K√ºnste?", options:["Schillerplatz 3","Anton-von-Webern-Platz 1","Spitalgasse 23","Welthandelsplatz 1","Karlsplatz 13","Universit√§tsring 1"], correct:0, coords:[48.2020,16.3640] }
  ],
  museen: [
    { name:"Albertina", question:"Wo liegt die Albertina?", options:["Albertinaplatz 1","Museumsplatz 1","Mariahilfer Stra√üe 1","Stephansplatz 1","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2043,16.3686] },
    { name:"Naturhistorisches Museum", question:"Wo liegt das NHM?", options:["Maria-Theresien-Platz","Heldenplatz","Museumsplatz 1","Burgring 1","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2056,16.3613] },
    { name:"Kunsthistorisches Museum", question:"Wo liegt das KHM?", options:["Maria-Theresien-Platz","Heldenplatz","Museumsplatz 1","Burgring 1","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2037,16.3618] },
    { name:"MUMOK", question:"Wo liegt das MUMOK?", options:["Museumsplatz 1","Maria-Theresien-Platz","Heldenplatz","Burgring 1","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2035,16.3585] },
    { name:"Leopold Museum", question:"Wo liegt das Leopold Museum?", options:["Museumsplatz 1","Maria-Theresien-Platz","Heldenplatz","Burgring 1","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2040,16.3590] },
    { name:"Weltmuseum Wien", question:"Wo liegt das Weltmuseum Wien?", options:["Heldenplatz","Museumsplatz 1","Maria-Theresien-Platz","Burgring 1","Ballhausplatz 1","Rathausplatz 1"], correct:0, coords:[48.2058,16.3636] }
  ],
  bauten: [
    { name:"Hofburg", question:"Hofburg/Heldenplatz geh√∂rt zu ‚Ä¶", options:["Ringstra√üe","K√§rntnerring","G√ºrtel","Franz-Josefs-Kai","Ballhausplatz","Rathausplatz"], correct:0, coords:[48.2066,16.3636] },
    { name:"Stephansdom", question:"Stephansdom liegt am ‚Ä¶", options:["Stephansplatz","Graben","K√§rntner Stra√üe","Ringstra√üe","Ballhausplatz","Rathausplatz"], correct:0, coords:[48.2085,16.3730] },
    { name:"Belvedere", question:"Belvedere liegt ‚Ä¶", options:["Prinz-Eugen-Stra√üe 27","Stephansplatz","Graben","K√§rntner Stra√üe","Ringstra√üe","Ballhausplatz"], correct:0, coords:[48.1915,16.3810] },
    { name:"Schloss Sch√∂nbrunn", question:"Schloss Sch√∂nbrunn liegt ‚Ä¶", options:["Sch√∂nbrunner Schlo√üstra√üe 47","Prinz-Eugen-Stra√üe 27","Stephansplatz","Graben","K√§rntner Stra√üe","Ringstra√üe"], correct:0, coords:[48.1853,16.3122] },
    { name:"Hundertwasserhaus", question:"Hundertwasserhaus liegt ‚Ä¶", options:["Kegelgasse 36-38","Sch√∂nbrunner Schlo√üstra√üe 47","Prinz-Eugen-Stra√üe 27","Stephansplatz","Graben","K√§rntner Stra√üe"], correct:0, coords:[48.2070,16.3940] },
    { name:"UNO-City", question:"UNO-City liegt ‚Ä¶", options:["Wagramer Stra√üe 5","Kegelgasse 36-38","Sch√∂nbrunner Schlo√üstra√üe 47","Prinz-Eugen-Stra√üe 27","Stephansplatz","Graben"], correct:0, coords:[48.2330,16.4160] }
  ],
  guertel: [
    { name:"G√ºrtel-Kreuzung", question:"Ist diese Kreuzung am inneren oder am √§u√üeren G√ºrtel? (Mariahilfer Stra√üe)", options:["innerer G√ºrtel","√§u√üerer G√ºrtel"], correct:0, coords:[48.1956,16.3394] },
    { name:"G√ºrtel-Kreuzung", question:"Ist diese Kreuzung am inneren oder am √§u√üeren G√ºrtel? (Nu√üdorfer Stra√üe)", options:["innerer G√ºrtel","√§u√üerer G√ºrtel"], correct:0, coords:[48.2332,16.3554] },
    { name:"nach dem G√ºrtel", question:"Wie hei√üt die Stra√üe weiter, nachdem Sie die Mariahilfer Stra√üe √ºber den G√ºrtel gequert haben?", options:["Sechshauser Stra√üe","Burggasse","Thaliastra√üe","Winckelmannstra√üe","Gumpendorfer Stra√üe","Lerchenfelder Stra√üe"], correct:0, coords:[48.1935,16.3354] },
    { name:"nach dem G√ºrtel", question:"Wie hei√üt die Stra√üe weiter, nachdem Sie die Burggasse √ºber den G√ºrtel gequert haben?", options:["Gablenzgasse","Lerchenfelder G√ºrtel","Thaliastra√üe","Mariahilfer Stra√üe","Sechshauser Stra√üe","Gumpendorfer Stra√üe"], correct:0, coords:[48.2058,16.3389] },
    { name:"nach dem G√ºrtel", question:"Wie hei√üt die Stra√üe weiter, nachdem Sie die Lerchenfelder Stra√üe √ºber den G√ºrtel gequert haben?", options:["Thaliastra√üe","Gablenzgasse","Lerchenfelder G√ºrtel","Mariahilfer Stra√üe","Sechshauser Stra√üe","Gumpendorfer Stra√üe"], correct:0, coords:[48.2094,16.3367] },
    { name:"nach dem G√ºrtel", question:"Wie hei√üt die Stra√üe weiter, nachdem Sie die Hernalser Hauptstra√üe √ºber den G√ºrtel gequert haben?", options:["Ottakringer Stra√üe","Thaliastra√üe","Gablenzgasse","Lerchenfelder G√ºrtel","Mariahilfer Stra√üe","Sechshauser Stra√üe"], correct:0, coords:[48.2185,16.3326] }
  ],
  donau: [
    { name:"Schwedenbr√ºcke", question:"Welche Br√ºcke verbindet Rotenturmstra√üe mit der Taborstra√üe?", options:["Schwedenbr√ºcke","Aspernbr√ºcke","Salztorbr√ºcke","Marienbr√ºcke","Reichsbr√ºcke","Floridsdorfer Br√ºcke"], correct:0, coords:[48.2125,16.3783] },
    { name:"Reichsbr√ºcke", question:"Welche Br√ºcke verbindet die Innere Stadt mit der Donaustadt?", options:["Reichsbr√ºcke","Schwedenbr√ºcke","Aspernbr√ºcke","Salztorbr√ºcke","Marienbr√ºcke","Floridsdorfer Br√ºcke"], correct:0, coords:[48.2310,16.4140] },
    { name:"Floridsdorfer Br√ºcke", question:"Welche Br√ºcke verbindet Brigittenau mit Floridsdorf?", options:["Floridsdorfer Br√ºcke","Reichsbr√ºcke","Schwedenbr√ºcke","Aspernbr√ºcke","Salztorbr√ºcke","Marienbr√ºcke"], correct:0, coords:[48.2500,16.3900] },
    { name:"Augartenbr√ºcke", question:"Welche Br√ºcke verbindet Leopoldstadt mit Brigittenau?", options:["Augartenbr√ºcke","Floridsdorfer Br√ºcke","Reichsbr√ºcke","Schwedenbr√ºcke","Aspernbr√ºcke","Salztorbr√ºcke"], correct:0, coords:[48.2280,16.3730] },
    { name:"Rotundenbr√ºcke", question:"Welche Br√ºcke verbindet Prater mit Donaustadt?", options:["Rotundenbr√ºcke","Augartenbr√ºcke","Floridsdorfer Br√ºcke","Reichsbr√ºcke","Schwedenbr√ºcke","Aspernbr√ºcke"], correct:0, coords:[48.2130,16.4080] }
  ],
  nummern: [
    { name:"Nummerierung", question:"Wie werden die H√§user in Wien nummeriert?", options:["Ungerade links / gerade rechts stadtausw√§rts","Gerade links / ungerade rechts stadtausw√§rts","Fortlaufend im Uhrzeigersinn","Nur ungerade Nummern in Wien","Alphabetisch nach Stra√üennamen","Nach Bezirksnummern"], correct:0, coords:[48.206,16.372] },
    { name:"Bezirksnummern", question:"Wie sind die Bezirke in Wien nummeriert?", options:["Im Uhrzeigersinn um den 1. Bezirk","Nach Einwohnerzahl","Alphabetisch","Nach Gr√ºndungsdatum","Nach Fl√§chengr√∂√üe","Zuf√§llig"], correct:0, coords:[48.206,16.372] }
  ],
  strassgeo: [
    { name:"Praterstern", question:"Nennen Sie zwei stadtausw√§rts f√ºhrende Stra√üen vom Praterstern.", options:["Praterstra√üe & Ausstellungsstra√üe","K√§rntner Stra√üe & Opernring","Mariahilfer Stra√üe & Burggasse","W√§hringer Stra√üe & Hernalser Hauptstra√üe","Ringstra√üe & Franz-Josefs-Kai","Donaukanalstra√üe & Schwedenplatz"], correct:0, coords:[48.2167,16.3925] },
    { name:"Schwarzenbergplatz", question:"Welche Stra√üen f√ºhren vom Schwarzenbergplatz weg?", options:["Ringstra√üe & Lothringerstra√üe","K√§rntner Stra√üe & Opernring","Mariahilfer Stra√üe & Burggasse","W√§hringer Stra√üe & Hernalser Hauptstra√üe","Praterstra√üe & Ausstellungsstra√üe","Donaukanalstra√üe & Schwedenplatz"], correct:0, coords:[48.2020,16.3750] },
    { name:"Westbahnhof", question:"Welche Stra√üen f√ºhren vom Westbahnhof weg?", options:["Mariahilfer Stra√üe & Europaplatz","G√ºrtel & Mariahilfer Stra√üe","Lerchenfelder Stra√üe & Burggasse","Thaliastra√üe & Gablenzgasse","Sechshauser Stra√üe & Gumpendorfer Stra√üe","Neubaug√ºrtel & Mariahilfer G√ºrtel"], correct:0, coords:[48.1965,16.3380] }
  ],
  wichtige: [
    { name:"Ringstra√üe", question:"Zum Ring geh√∂ren ‚Ä¶", options:["Opernring / Burgring / Universit√§tsring","K√§rntner Stra√üe / Graben","G√ºrtel / Triester Stra√üe","Donauufer Autobahn","Praterstra√üe / Ausstellungsstra√üe","Mariahilfer Stra√üe / Neubaug√ºrtel"], correct:0, coords:[48.2053,16.3685] },
    { name:"G√ºrtel", question:"Welche G√ºrtelteile geh√∂ren zum G√ºrtel?", options:["Mariahilfer G√ºrtel / W√§hringer G√ºrtel / Lerchenfelder G√ºrtel","Ringstra√üe / Franz-Josefs-Kai","K√§rntner Stra√üe / Graben","Praterstra√üe / Ausstellungsstra√üe","Donauufer Autobahn / S√ºdosttangente","Triester Stra√üe / Prager Stra√üe"], correct:0, coords:[48.2000,16.3400] },
    { name:"S√ºdosttangente", question:"Was ist die S√ºdosttangente?", options:["A23 Autobahn","G√ºrtel","Ringstra√üe","Donauufer Autobahn","Westautobahn","S√ºdautobahn"], correct:0, coords:[48.1600,16.4200] },
    { name:"Westautobahn", question:"Wo beginnt die Westautobahn in Wien?", options:["Auhof","Hietzing","Penzing","Ottakring","Hernals","W√§hring"], correct:0, coords:[48.2080,16.2530] }
  ],
  tarif: [
    { name:"Grundtaxe", question:"Wie hoch ist die Grundtaxe am Tag?", options:["3,80 ‚Ç¨","4,30 ‚Ç¨","3,50 ‚Ç¨","2,90 ‚Ç¨","5,00 ‚Ç¨","4,80 ‚Ç¨"], correct:0 },
    { name:"Grundtaxe Nacht", question:"Wie hoch ist die Grundtaxe nachts/So/Feiertag?", options:["4,30 ‚Ç¨","3,80 ‚Ç¨","5,00 ‚Ç¨","4,90 ‚Ç¨","3,50 ‚Ç¨","4,00 ‚Ç¨"], correct:0 },
    { name:"Kilometerpreis", question:"Wie viel kostet der Kilometer nach Tarif 2?", options:["1,80 ‚Ç¨","2,10 ‚Ç¨","1,50 ‚Ç¨","2,50 ‚Ç¨","1,30 ‚Ç¨","1,95 ‚Ç¨"], correct:0 },
    { name:"Wartezeit", question:"Wie hoch ist die Zeittaxe f√ºr eine Stunde Wartezeit?", options:["34,80 ‚Ç¨","28,00 ‚Ç¨","40,00 ‚Ç¨","20,00 ‚Ç¨","30,00 ‚Ç¨","25,00 ‚Ç¨"], correct:0 },
    { name:"Nachtzuschlag", question:"Ab wann gilt der Nachtzuschlag?", options:["23:00‚Äì06:00","22:00‚Äì05:00","00:00‚Äì06:00","21:00‚Äì05:00","22:30‚Äì05:30","23:30‚Äì06:30"], correct:0 },
    { name:"Gep√§ck", question:"Was kostet ein Gep√§ckst√ºck?", options:["Kostenlos","0,50 ‚Ç¨","1,00 ‚Ç¨","1,50 ‚Ç¨","2,00 ‚Ç¨","2,50 ‚Ç¨"], correct:0 }
  ],
  stvo: [
    { name:"Wohnstra√üe", question:"D√ºrfen Taxis durch Wohnstra√üen durchfahren?", options:["Nur Schrittgeschwindigkeit (4‚Äì5 km/h)","Ja, ohne Einschr√§nkung","Nein, verboten","Nur tags√ºber","Nur mit Sondergenehmigung","Nur zum Ein- und Aussteigen"], correct:0 },
    { name:"Rettungsgasse", question:"Wo muss eine Rettungsgasse gebildet werden?", options:["Auf Autobahnen & Schnellstra√üen","Nur im Ortsgebiet","Nirgendwo","Auf Landstra√üen","In Tunnel","Auf Br√ºcken"], correct:0 },
    { name:"Geschwindigkeit Ortsgebiet", question:"Wie hoch ist die H√∂chstgeschwindigkeit im Ortsgebiet?", options:["50 km/h","30 km/h","60 km/h","70 km/h","40 km/h","80 km/h"], correct:0 },
    { name:"Handy am Steuer", question:"Darf man als Taxilenker das Handy benutzen?", options:["Nur mit Freisprecheinrichtung","Ja, ohne Einschr√§nkung","Nein, niemals","Nur im Stand","Nur mit Headset","Nur f√ºr Navigationsger√§t"], correct:0 },
    { name:"Alkoholgrenze", question:"Wie hoch ist die Promillegrenze f√ºr Taxilenker?", options:["0,1 ‚Ä∞","0,5 ‚Ä∞","0,0 ‚Ä∞","0,2 ‚Ä∞","0,3 ‚Ä∞","0,4 ‚Ä∞"], correct:0 },
    { name:"Kindersitz", question:"Ab wann braucht ein Kind einen Kindersitz im Taxi?", options:["Bis 14 Jahre oder 150 cm","Bis 12 Jahre","Bis 10 Jahre","Bis 8 Jahre","Bis 6 Jahre","Immer"], correct:0 }
  ],
  kfg: [
    { name:"Winterreifenpflicht", question:"F√ºr Taxis gilt Winterreifenpflicht ‚Ä¶", options:["1. Nov ‚Äì 15. Apr (bei winterlichen Fahrbahnverh√§ltnissen)","1. Okt ‚Äì 1. M√§rz","Ganzj√§hrig","Nur bei Schnee","1. Dez ‚Äì 28. Feb","Nur auf Autobahnen"], correct:0 },
    { name:"Hauptuntersuchung", question:"Wie oft muss ein Taxi zur Hauptuntersuchung?", options:["Einmal j√§hrlich","Alle 2 Jahre","Alle 6 Monate","Alle 3 Jahre","Bei Bedarf","Nur bei Defekten"], correct:0 },
    { name:"Lenkzeit", question:"Wie lange darf ein Taxilenker maximal am St√ºck lenken?", options:["4,5 Stunden","6 Stunden","8 Stunden","10 Stunden","12 Stunden","Keine Begrenzung"], correct:0 },
    { name:"Ruhezeit", question:"Wie lange muss die t√§gliche Ruhezeit mindestens sein?", options:["11 Stunden","8 Stunden","10 Stunden","9 Stunden","12 Stunden","6 Stunden"], correct:0 }
  ],
  arbeit: [
    { name:"Mindestlohn", question:"Der KV-Mindestlohn im Taxigewerbe gilt ‚Ä¶", options:["√ñsterreichweit (Bundesgebiet)","Nur in Wien","Nur f√ºr Unternehmer","Nur f√ºr Angestellte","Nur in Gro√üst√§dten","Nur f√ºr Vollzeitkr√§fte"], correct:0 },
    { name:"Arbeitszeit", question:"Wie lange darf die t√§gliche Arbeitszeit maximal sein?", options:["12 Stunden","8 Stunden","10 Stunden","9 Stunden","11 Stunden","13 Stunden"], correct:0 },
    { name:"Urlaubsanspruch", question:"Wie viele Tage Urlaub stehen einem Taxilenker pro Jahr zu?", options:["25 Tage","20 Tage","30 Tage","22 Tage","24 Tage","26 Tage"], correct:0 },
    { name:"K√ºndigungsfrist", question:"Wie lange betr√§gt die K√ºndigungsfrist im Taxigewerbe?", options:["6 Wochen","4 Wochen","8 Wochen","2 Wochen","3 Monate","1 Monat"], correct:0 }
  ]
};

// G√ºrtel-—É–∑–ª—ã –¥–ª—è —É—á–µ–±–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
const GUERTEL_INTERSECTIONS = [
  { title:"Mariahilfer Stra√üe √ó Mariahilfer G√ºrtel", side:"innerer", coords:[48.1956,16.3394] },
  { title:"Nu√üdorfer Stra√üe √ó W√§hringer G√ºrtel", side:"innerer", coords:[48.2332,16.3554] },
  { title:"Burggasse √ó Neubaug√ºrtel", side:"innerer", coords:[48.2058,16.3389] },
  { title:"Thaliastra√üe √ó Lerchenfelder G√ºrtel", side:"innerer", coords:[48.2094,16.3367] },
  { title:"Hernalser Hauptstra√üe √ó Hernalser G√ºrtel", side:"innerer", coords:[48.2185,16.3326] },
  { title:"Ottakringer Stra√üe √ó Ottakringer G√ºrtel", side:"√§u√üerer", coords:[48.2148,16.3200] }
];

// ============ Helpers ============
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
const toast = (m,ms=1500)=>{ const t=$("#toast"); t.textContent=m; t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),ms); };
function shuffle(a){ const x=a.slice(); for(let i=x.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [x[i],x[j]]=[x[j],x[i]] } return x; }

// ============ Map ============
const map = L.map('map',{zoomControl:true}).setView([48.2082,16.3738],13);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{ attribution:'¬© OpenStreetMap' }).addTo(map);

// –°–æ–∑–¥–∞–µ–º —Å–ª–æ–∏ –¥–ª—è –º–∞—Ä–∫–µ—Ä–æ–≤
const questionMarkers = L.layerGroup().addTo(map);
const answerMarkers = L.layerGroup().addTo(map);

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –º–∞—Ä–∫–µ—Ä–æ–≤
function createCustomMarker(color, className) {
  return L.divIcon({
    className: className,
    html: `<div style="background-color: ${color}; border: 3px solid #fff; border-radius: 50%; width: 20px; height: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>`,
    iconSize: [20, 20],
    iconAnchor: [10, 10]
  });
}

// –°–æ–∑–¥–∞–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã
const questionMarker = createCustomMarker('#2563eb', 'marker-question');
const correctMarker = createCustomMarker('#16a34a', 'marker-correct');
const incorrectMarker = createCustomMarker('#dc2626', 'marker-incorrect');

function fly([lat,lng], zoom=16){ map.flyTo([lat,lng], zoom, {duration:1.0}); }

// ============ Data Management ============
let DATA = {};

function loadQuestions() {
  const saved = localStorage.getItem('taxiQuizQuestions');
  if (saved) {
    DATA = JSON.parse(saved);
  } else {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
    DATA = JSON.parse(JSON.stringify(DEFAULT_QUESTIONS));
    saveQuestions();
  }
  updateCategoryCounts();
}

function saveQuestions() {
  localStorage.setItem('taxiQuizQuestions', JSON.stringify(DATA));
}

function updateCategoryCounts() {
  THEMEN.forEach(t => {
    const count = DATA[t.key]?.length || 0;
    const countElement = $(`.cat input[value="${t.key}"]`).closest('.cat').querySelector('.count');
    if (countElement) {
      countElement.textContent = count;
    }
  });
}

// ============ Statistics ============
let stats = {
  total: 0,
  correct: 0,
  get accuracy() {
    return this.total > 0 ? Math.round((this.correct / this.total) * 100) : 0;
  }
};

function updateStatsDisplay() {
  $("#correctCount").textContent = stats.correct;
  $("#totalCount").textContent = stats.total;
  $("#accuracy").textContent = stats.accuracy + '%';
}

function saveStats() {
  localStorage.setItem('taxiQuizStats', JSON.stringify(stats));
}

function loadStats() {
  const saved = localStorage.getItem('taxiQuizStats');
  if (saved) {
    stats = JSON.parse(saved);
  }
  updateStatsDisplay();
}

function resetStats() {
  stats = { total: 0, correct: 0 };
  saveStats();
  updateStatsDisplay();
  toast("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–±—Ä–æ—à–µ–Ω–∞");
}

// ============ Quiz Engine ============
let selected=[], pool=[], idx=0, score=0, examMode=false;

function buildPool(keys){
  const out=[];
  keys.forEach(k=>{ if(DATA[k]) out.push(...DATA[k]); });
  return shuffle(out);
}

function startQuiz(mode="normal"){
  const checked = $$("#catList input[type=checkbox]:checked").map(x=>x.value);
  if(checked.length===0){ toast("Bitte Kategorie w√§hlen!"); return; }
  selected=checked; examMode=(mode==="exam"); pool=buildPool(selected);
  if(examMode && pool.length>10) pool=pool.slice(0,10);
  idx=0; score=0;
  
  // –û—á–∏—â–∞–µ–º –º–∞—Ä–∫–µ—Ä—ã –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –Ω–æ–≤–æ–π –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
  questionMarkers.clearLayers();
  answerMarkers.clearLayers();
  
  $("#quizPanel").style.display="block";
  $("#sidebar").style.display="none";
  $("#studyPanel").style.display="none";
  $("#statsPanel").style.display="none";
  $("#editPanel").style.display="none";
  showQuestion(true);
}

function showQuestion(first=false){
  const q = pool[idx]; if(!q) return;
  $("#progress").textContent=`Frage ${idx+1} von ${pool.length}`;
  $("#progressFill").style.width = `${Math.round((idx)/pool.length*100)}%`;
  $("#questionText").textContent=q.question;
  const cont=$("#optionsContainer"); cont.innerHTML="";
  
  // –§–∏–ª—å—Ç—Ä—É–µ–º –ø—É—Å—Ç—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
  const validOptions = q.options.filter(opt => opt && opt.trim() !== '');
  
  shuffle(validOptions).forEach((opt,i)=>{
    const d=document.createElement("div");
    d.className="option"; d.tabIndex=0; d.dataset.correct=(opt===q.correct);
    d.innerHTML=`<strong>${i+1}.</strong> ${opt}`;
    d.onclick = ()=>checkAnswer(d,opt);
    d.onkeydown = (e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); d.click(); } };
    cont.appendChild(d);
  });
  $("#nextBtn").style.display="none";
  $("#endBtns").style.display="none";
  
  // –û–∑–≤—É—á–∫–∞
  speak(q.question);
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞ –∫–∞—Ä—Ç–µ –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
  if(Array.isArray(q.coords)){ 
    fly(q.coords,16); 
    
    // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Ä–∫–µ—Ä –≤–æ–ø—Ä–æ—Å–∞
    questionMarkers.clearLayers();
    L.marker(q.coords, {icon: questionMarker})
      .addTo(questionMarkers)
      .bindPopup(`<b>${q.name}</b><br>${q.question}`)
      .openPopup(); 
  }
}

function checkAnswer(el,opt){
  const q=pool[idx];
  const ok=(opt===q.correct);
  $$("#optionsContainer .option").forEach(o=>o.onclick=null);
  el.classList.add(ok?"correct":"incorrect");
  if(!ok){ 
    const r=$$("#optionsContainer .option").find(x=>x.dataset.correct==="true"); 
    if(r) r.classList.add("correct"); 
  }
  if(ok) score++;

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  stats.total++;
  if(ok) stats.correct++;
  saveStats();
  updateStatsDisplay();

  // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Ä–∫–µ—Ä –æ—Ç–≤–µ—Ç–∞ (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
  if(Array.isArray(q.coords)){ 
    const markerIcon = ok ? correctMarker : incorrectMarker;
    L.marker(q.coords, {icon: markerIcon})
      .addTo(answerMarkers)
      .bindPopup(`<b>${q.name}</b><br>${ok ? "‚úÖ Richtig" : "‚ùå Falsch"}`)
      .openPopup(); 
  }

  speak(ok ? "Richtig. Gut gemacht." : `Leider falsch. Richtig ist: ${q.correct}.`);
  $("#nextBtn").style.display="block";
}

function nextQuestion(){
  idx++;
  if(idx<pool.length){ showQuestion(); }
  else{
    $("#questionText").textContent=`Fertig! Punkte: ${score}/${pool.length}`;
    $("#optionsContainer").innerHTML="";
    $("#progress").textContent=""; $("#progressFill").style.width="100%";
    $("#nextBtn").style.display="none"; $("#endBtns").style.display="block";
    speak(`Fertig. Punkte: ${score} von ${pool.length}.`);
  }
}

function backToMenu(){ 
  $("#quizPanel").style.display="none"; 
  $("#sidebar").style.display="block"; 
  $("#endBtns").style.display="none"; 
}

function restartQuiz(){ 
  $("#endBtns").style.display="none"; 
  idx=0; 
  score=0; 
  pool=shuffle(pool); 
  
  // –û—á–∏—â–∞–µ–º –º–∞—Ä–∫–µ—Ä—ã –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
  questionMarkers.clearLayers();
  answerMarkers.clearLayers();
  
  showQuestion(true); 
}

// ============ G√ºrtel Study ============
function openStudy(){
  $("#studyPanel").style.display="block";
  $("#statsPanel").style.display="none";
  $("#sidebar").style.display="none";
  $("#quizPanel").style.display="none";
  $("#editPanel").style.display="none";
  const list=$("#studyList"); list.innerHTML="";
  GUERTEL_INTERSECTIONS.forEach((g,i)=>{
    const div=document.createElement("div");
    div.className="item";
    div.style.cssText="padding:8px 10px;border-bottom:1px dashed var(--border);cursor:pointer";
    div.innerHTML = `${i+1}. ${g.title} ‚Äî <span class="badge ${g.side==='innerer'?'badge-inner':'badge-outer'}">${g.side} G√ºrtel</span>`;
    div.onclick = ()=> {
      fly(g.coords, 16);
      // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –º–∞—Ä–∫–µ—Ä—ã –∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π
      questionMarkers.clearLayers();
      answerMarkers.clearLayers();
      L.marker(g.coords, {icon: questionMarker})
        .addTo(questionMarkers)
        .bindPopup(`<b>${g.title}</b><br><span class="badge ${g.side==='innerer'?'badge-inner':'badge-outer'}">${g.side} G√ºrtel</span>`)
        .openPopup();
    };
    list.appendChild(div);
  });
  toast("–£—á–µ–±–Ω—ã–π —Ä–µ–∂–∏–º G√ºrtel –æ—Ç–∫—Ä—ã—Ç");
}

// ============ Question Editor ============
function openEditor(){
  $("#editPanel").style.display="block";
  $("#statsPanel").style.display="none";
  $("#sidebar").style.display="none";
  $("#quizPanel").style.display="none";
  $("#studyPanel").style.display="none";
  
  // –ó–∞–ø–æ–ª–Ω—è–µ–º select –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
  const categorySelect = $("#categorySelect");
  categorySelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>';
  THEMEN.forEach(t => {
    const option = document.createElement("option");
    option.value = t.key;
    option.textContent = `${t.title} (${DATA[t.key]?.length || 0} –≤–æ–ø—Ä–æ—Å–æ–≤)`;
    categorySelect.appendChild(option);
  });
}

function saveNewQuestion(){
  const category = $("#categorySelect").value;
  const name = $("#questionName").value.trim();
  const question = $("#questionTextEdit").value.trim();
  const options = [
    $("#option1").value.trim(),
    $("#option2").value.trim(),
    $("#option3").value.trim(),
    $("#option4").value.trim(),
    $("#option5").value.trim(),
    $("#option6").value.trim()
  ].filter(opt => opt !== '');
  
  const correctIndex = parseInt($("#correctAnswer").value);
  
  if (!category || !name || !question || options.length < 2 || isNaN(correctIndex)) {
    toast("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ!");
    return;
  }
  
  if (!DATA[category]) {
    DATA[category] = [];
  }
  
  const newQuestion = {
    name,
    question,
    options,
    correct: options[correctIndex]
  };
  
  DATA[category].push(newQuestion);
  saveQuestions();
  updateCategoryCounts();
  
  // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
  $("#questionName").value = "";
  $("#questionTextEdit").value = "";
  $("#option1").value = "";
  $("#option2").value = "";
  $("#option3").value = "";
  $("#option4").value = "";
  $("#option5").value = "";
  $("#option6").value = "";
  $("#correctAnswer").value = "";
  
  toast("–í–æ–ø—Ä–æ—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω!");
}

function loadDefaultQuestions(){
  if(confirm("–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã? –¢–µ–∫—É—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.")){
    DATA = JSON.parse(JSON.stringify(DEFAULT_QUESTIONS));
    saveQuestions();
    updateCategoryCounts();
    toast("–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã");
  }
}

// ============ TTS (ElevenLabs) ============
let ttsOn=true; 
const audioEl=new Audio(); 
audioEl.volume=1;
let queue=[], playing=false;

function speak(text){
  if(!ttsOn || !text) return;
  queue.push(text);
  if(!playing) nextSpeak();
}

async function nextSpeak(){
  if(queue.length===0){ playing=false; return; }
  playing=true; const text=queue.shift();
  try{
    const res = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${ELEVEN_VOICE_ID}?optimize_streaming_latency=3`,{
      method:"POST",
      headers:{ "xi-api-key": ELEVEN_API_KEY, "Content-Type":"application/json", "Accept":"audio/mpeg" },
      body: JSON.stringify({ 
        text: text, 
        model_id:"eleven_multilingual_v2", 
        voice_settings:{ 
          stability:0.4, 
          similarity_boost:0.8, 
          style:0, 
          use_speaker_boost:true 
        } 
      })
    });
    if(res.ok){
      const blob = await res.blob();
      audioEl.src = URL.createObjectURL(blob);
      await audioEl.play();
      audioEl.onended = ()=> nextSpeak();
    }
  }catch(e){
    console.warn("TTS error",e); 
    playing=false;
  }
}

function stopSpeak(){ 
  try{ 
    audioEl.pause(); 
    audioEl.currentTime=0; 
  }catch{} 
  queue=[]; 
  playing=false; 
}

// ============ UI Bindings ============
function loadCats(){
  const wrap=$("#catList"); wrap.innerHTML="";
  THEMEN.forEach(t=>{
    const count = DATA[t.key]?.length || 0;
    const div=document.createElement("label"); div.className="cat";
    div.innerHTML = `<input type="checkbox" value="${t.key}" checked> <div>${t.title} <span class="small">(${t.pages})</span></div> <span class="count">${count}</span>`;
    wrap.appendChild(div);
  });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
$("#menuBtn").onclick = ()=>{ 
  const s=$("#sidebar"); 
  s.style.display=(s.style.display==="block"?"none":"block"); 
};

$("#startBtn").onclick = ()=>{ startQuiz("normal"); };
$("#examBtn").onclick  = ()=>{ startQuiz("exam"); };
$("#nextBtn").onclick  = nextQuestion;
$("#againBtn").onclick = restartQuiz;
$("#backBtn").onclick  = backToMenu;
$("#studyBtn").onclick = openStudy;
$("#editBtn").onclick = openEditor;
$("#statsBtn").onclick = ()=>{ 
  $("#statsPanel").style.display="block"; 
  $("#studyPanel").style.display="none"; 
  $("#sidebar").style.display="none"; 
  $("#quizPanel").style.display="none"; 
  $("#editPanel").style.display="none";
};
$("#ttsToggleBtn").onclick = ()=>{ 
  ttsOn=!ttsOn; 
  toast(ttsOn?"üîä –û–∑–≤—É—á–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞":"üîá –û–∑–≤—É—á–∫–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞"); 
  if(!ttsOn) stopSpeak(); 
};
$("#resetStats").onclick = resetStats;
$("#saveQuestion").onclick = saveNewQuestion;
$("#loadDefault").onclick = loadDefaultQuestions;

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
document.addEventListener("keydown",(e)=>{
  if($("#quizPanel").style.display!=="block") return;
  const i=["1","2","3","4","5","6"].indexOf(e.key);
  if(i>=0){ 
    const opt=$$("#optionsContainer .option")[i]; 
    if(opt && opt.onclick) opt.click(); 
  }
  if(e.key==="Enter" && $("#nextBtn").style.display==="block") nextQuestion();
});

// –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
window.addEventListener("load", ()=>{ 
  loadQuestions();
  loadStats();
  loadCats();
  toast("Willkommen! W√§hlen Sie Themen aus."); 
  
  // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –ø–∞–Ω–µ–ª–∏ –∫—Ä–æ–º–µ —Å–∞–π–¥–±–∞—Ä–∞
  $("#statsPanel").style.display="none";
  $("#editPanel").style.display="none";
  $("#studyPanel").style.display="none";
  $("#quizPanel").style.display="none";
});
</script>
</body>
</html>
